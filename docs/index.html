<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Perceptron-C | Grid Search</title>

  <!-- Plotly JS (global window.Plotly) -->
  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>

  <!-- PyScript core -->
  <link rel="stylesheet" href="https://pyscript.net/releases/2024.5.1/core.css" />
  <script type="module" src="https://pyscript.net/releases/2024.5.1/core.js"></script>

  <!-- Declare which Python packages to preload -->
  <py-config>
    packages = [
      "pandas",
      "plotly",
      "numpy"
    ]
  </py-config>
  
  <link rel="stylesheet" href="assets/style.css" />
</head>
<body>

  <header class="site-header">
    <div class="container">
      <h1>Perceptron-C</h1>
      <h2 class="muted">Hyperparameter Grid Search</h2>
      <p class="tagline">Analyze grid runs • Compare speed vs accuracy • Interactive charts</p>
    </div>
  </header>

  <main class="container">

    <div class="status mono small">Status: <span id="status-text">idle</span></div>

    <div class="tabs">
      <button class="tab active" data-panel="upload">CSV / Logs</button>
      <button class="tab" data-panel="charts">Charts</button>
      <button class="tab" data-panel="summary">Summary</button>
    </div>

    <!-- Upload / Parse panel -->
    <section id="panel-upload" class="panel active">
    <div class="card">
        <label class="label">Select results CSV from repo (docs/csv)</label>

        <div class="row">
        <div class="inline">
            <select id="csv-select"></select>
        </div>
        <button id="btn-reload-index" class="secondary">Reload List</button>
        <button id="btn-load-selected" class="primary">Load Selected</button>
        </div>

        <!-- Progress bar + text (reused by app.py) -->
        <div class="progress-wrap">
        <progress id="csv-progress" max="100" value="0"></progress>
        <span id="csv-progress-text">0%</span>
        </div>

        <div id="csv-preview" class="log mono small"></div>
    </div>
    </section>


    <!-- Charts panel -->
    <section id="panel-charts" class="panel">
      <div class="card">
        <div class="row controls">
          <!-- controls unchanged -->
        </div>

        <div class="grid-2">
          <!-- UPDATED ID -->
          <div id="plots" class="result-tile" style="min-height: 420px;"></div>
          <div id="plot-speed-acc-sigma" class="result-tile" style="min-height: 420px;"></div>
        </div>
      </div>
    </section>

    <!-- Summary panel -->
    <section id="panel-summary" class="panel">
      <div class="card">
        <div class="row">
          <button id="btn-export-md" class="primary">Export grid_data.md</button>
        </div>
        <div class="grid-2">
          <div class="result-tile">
            <div class="tile-title">Fastest Model</div>
            <div class="label-big" id="fast-time">—</div>
            <div class="light small" id="fast-meta">—</div>
          </div>
          <div class="result-tile">
            <div class="tile-title">Best Accuracy</div>
            <div class="label-big" id="best-acc">—</div>
            <div class="light small" id="best-meta">—</div>
          </div>
        </div>
        <div id="summary-log" class="log mono small"></div>
      </div>
    </section>

    <!-- PyScript app loader -->
    <py-script src="assets/app.py"></py-script>

  </main>

  <footer class="foot small">
    <span id="year"></span> perceptron-c • MNIST bench & viz
  </footer>

  <script>
    // Tabs
    const tabs = document.querySelectorAll('.tab');
    const panels = {
      upload: document.getElementById('panel-upload'),
      charts: document.getElementById('panel-charts'),
      summary: document.getElementById('panel-summary'),
    };
    tabs.forEach(btn => {
      btn.addEventListener('click', () => {
        tabs.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        Object.values(panels).forEach(p => p.classList.remove('active'));
        panels[btn.dataset.panel].classList.add('active');
      });
    });
    // year
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>

</body>
</html>
